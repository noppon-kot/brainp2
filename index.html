<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brain Training Game</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 20px; }
        .hidden { display: none; }
        .numbers { font-size: 20px; font-weight: bold; color: blue; margin: 20px 0; white-space: pre-line; }
        .score, .time { font-size: 18px; margin: 10px 0; }
        #answer { font-size: 20px; width: 80px; padding: 10px; text-align: center; }
        button { padding: 10px 20px; font-size: 16px; margin-top: 20px; }
        .button-group { display: flex; justify-content: center; gap: 10px; }
    </style>
</head>
<body>
    <h1>BrainTraining P2</h1>
    <div id="questionNumber" class="score hidden">Question: 1</div>
    <div id="score" class="score hidden">Score: 0/0</div>
    <div id="time" class="time hidden">Time: 00:00</div>
    <div id="numbers" class="numbers hidden"></div>
    <input id="answer" class="hidden" type="text" placeholder="Enter answer" />
    <div class="button-group">
        <button id="startButton">Start</button>
        <button id="stopButton" class="hidden">Stop</button>
        <button id="enterButton" class="hidden">Enter</button>
    </div>
    <script>
        let currentQuestion = 0;
        let correctAnswers = 0;
        let totalQuestions = 50;
        let timeSeconds = 0;
        let timerRunning = false;
        let generatedNumbers = [];
        let timer;
    
        const startButton = document.getElementById("startButton");
        const stopButton = document.getElementById("stopButton");
        const enterButton = document.getElementById("enterButton");
        const answerInput = document.getElementById("answer");
        const scoreLabel = document.getElementById("score");
        const timeLabel = document.getElementById("time");
        const numbersLabel = document.getElementById("numbers");
        const questionNumberLabel = document.getElementById("questionNumber");
    
        startButton.addEventListener("click", startGame);
        stopButton.addEventListener("click", stopGame);
        enterButton.addEventListener("click", checkAnswerClick);
        answerInput.addEventListener("keydown", checkAnswerKey);
    
        function startGame() {
            currentQuestion = 0;
            correctAnswers = 0;
            timeSeconds = 0;
            timerRunning = true;
            scoreLabel.textContent = `Score: ${correctAnswers}/${totalQuestions}`;
            timeLabel.textContent = "Time: 00:00";
            questionNumberLabel.textContent = `Question: ${currentQuestion + 1}`;
    
            startButton.classList.add("hidden");
            stopButton.classList.remove("hidden");
            enterButton.classList.remove("hidden");
            answerInput.classList.remove("hidden");
            scoreLabel.classList.remove("hidden");
            timeLabel.classList.remove("hidden");
            questionNumberLabel.classList.remove("hidden");
            numbersLabel.classList.remove("hidden");
            answerInput.value = "";
            answerInput.focus();
    
            timer = setInterval(updateTime, 1000);
    
            showNextQuestion();
        }
    
        function showNextQuestion() {
            if (currentQuestion >= totalQuestions) {
                numbersLabel.textContent = "Game End!";
                scoreLabel.textContent = `Your Score: ${correctAnswers}/${totalQuestions}`;
                timeLabel.textContent = `Time: ${formatTime(timeSeconds)}`;
                answerInput.classList.add("hidden");
                enterButton.classList.add("hidden");
                startButton.classList.remove("hidden");
                clearInterval(timer);
                return;
            }
    
            generatedNumbers = [];
            let totalSum = 0;
    
            if (currentQuestion < totalQuestions / 2) {
                for (let i = 0; i < 8; i++) {
                    let num = randomInt(1, 9);
                    if (totalSum === 9) {
                        num = randomInt(-8, -1);
                    } else if (totalSum + num > 9) {
                        while (totalSum + num > 9) {
                            num = randomInt(1, 9);
                        }
                    }
                    generatedNumbers.push(num);
                    totalSum += num;
                }
            } else {
                for (let i = 0; i < 8; i++) {
                    let num;
                    if (i == 0) {
                        num = randomInt(1, 9);
                    } else if (i == 4) {
                        num = randomInt(-8, -1);
                    } else {
                        num = randomInt(1, 9);
                    }
                    generatedNumbers.push(num);
                    totalSum += num;
                }
            }
    
            const formattedNumbers = generatedNumbers.map(num => num.toString().padStart(3, ' '));
            numbersLabel.textContent = formattedNumbers.join("\n");
    
            answerInput.value = "";
            answerInput.focus();
            questionNumberLabel.textContent = `Question: ${currentQuestion + 1}`;
            currentQuestion++;
        }
    
        function checkAnswerKey(event) {
            if (event.key === "Enter") {
                processAnswer();
            }
        }
    
        function checkAnswerClick() {
            processAnswer();
        }
    
        function processAnswer() {
            const userAnswer = parseInt(answerInput.value);
            if (isNaN(userAnswer)) {
                return;
            }
            const correctAnswer = generatedNumbers.reduce((a, b) => a + b, 0);
            if (userAnswer === correctAnswer) {
                correctAnswers++;
            }
            scoreLabel.textContent = `Score: ${correctAnswers}/${totalQuestions}`;
            showNextQuestion();
        }
    
        function updateTime() {
            if (timerRunning) {
                timeSeconds++;
                timeLabel.textContent = `Time: ${formatTime(timeSeconds)}`;
            }
        }
    
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secondsLeft = seconds % 60;
            return `${minutes.toString().padStart(2, '0')}:${secondsLeft.toString().padStart(2, '0')}`;
        }
    
        function stopGame() {
            currentQuestion = 0;
            correctAnswers = 0;
            timeSeconds = 0;
            timerRunning = false;
            numbersLabel.textContent = "";
            scoreLabel.textContent = "Score: 0/0";
            timeLabel.textContent = "Time: 00:00";
            questionNumberLabel.textContent = "Question: 1";
            startButton.classList.remove("hidden");
            stopButton.classList.add("hidden");
            enterButton.classList.add("hidden");
            answerInput.classList.add("hidden");
            scoreLabel.classList.add("hidden");
            timeLabel.classList.add("hidden");
            questionNumberLabel.classList.add("hidden");
            clearInterval(timer);
        }
    
        function randomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
    </script>
</body>
</html>
